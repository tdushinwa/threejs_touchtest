function treeNode(a,b,c,d,e,f,g,h,i,j){this.id=a,this.parent=b,this.marrige=c,this.children=d,this.depth=e,this.x=f,this.y=g,this.z=h,this.color=i,this.detail=j}var drawing=function(){function a(){this.width=window.innerWidth,this.height=window.innerHeight,this.init(),this.initCamera(),this.initLight()}return a.prototype.init=function(){this.canvasFrame=document.getElementById("canvas_frame"),this.renderer=new THREE.WebGLRenderer,this.scene=new THREE.Scene,this.renderer.setSize(this.width,this.height),this.renderer.setClearColor(16777215,1),this.canvasFrame.appendChild(this.renderer.domElement)},a.prototype.initCamera=function(){this.camera=new THREE.PerspectiveCamera(30,this.width/this.height,.1,5e3),this.camera.position.set(0,0,1e3),this.camera.lookAt(new THREE.Vector3(0,0,0)),this.trackball=new THREE.TrackballControls(this.camera,this.renderer.domElement),this.trackball.noRotate=!1,this.trackball.rotateSpeed=3,this.trackball.noZoom=!1,this.trackball.zoomSpeed=.3,this.trackball.noPan=!1,this.trackball.panSpeed=.1,this.trackball.staticMoving=!1,this.trackball.dynamicDampingFactor=.2,this.trackball.minDistance=500,this.trackball.maxDistance=4e3,this.trackball.keys=[65,83,68]},a.prototype.cameraReset=function(){this.camera.lookAt(new THREE.Vector3(0,0,0)),this.camera.up=new THREE.Vector3(0,1,0),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=1e3,this.camera.rotateX(0),this.camera.rotateY(0),this.camera.rotateZ(0),this.camera.matrix.set(1,0,0,0,0,1,0,0,0,0,1,1e3,0,0,0,1)},a.prototype.initLight=function(){this.light=new THREE.AmbientLight(5592405),this.dlight=new THREE.DirectionalLight(16777215),this.dlight.position.set(-1,1,1).normalize(),this.scene.add(this.light),this.scene.add(this.dlight)},a.prototype.onWindowResize=function(){this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height)},a.prototype.onmousemove=function(a){var b=this.scene,c=this.renderer,d=this.camera,e=this.height,f=this.width;this.renderer.domElement.addEventListener("click",function(a){var g=a.pageX-c.domElement.offsetLeft,h=a.pageY-c.domElement.offsetTop;g=g/f*2-1,h=2*-(h/e)+1;var i=new THREE.Vector3(g,h,1);i.unproject(d);var j=new THREE.Raycaster(d.position,i.sub(d.position).normalize()),k=j.intersectObjects(b.children);k.length>0&&console.log(k[0].object.name)})},a.prototype.squareMesh=function(a,b,c,d,e){var f=new THREE.PlaneGeometry(d,d),g=new THREE.MeshLambertMaterial({color:e}),h=new THREE.Mesh(f,g);h.position.set(a,b,c),this.scene.add(h)},a.prototype.sphereMesh=function(a,b,c,d,e,f){var g=new THREE.SphereGeometry(d,20,20),h=new THREE.MeshLambertMaterial({color:e}),i=new THREE.Mesh(g,h);i.position.set(a,b,c),i.name="sphere"+f,this.scene.add(i)},a.prototype.lineMesh=function(a,b,c,d,e,f,g){var h=new THREE.Geometry,i=new THREE.LineBasicMaterial({color:g});h.vertices.push(new THREE.Vector3(a,b,c),new THREE.Vector3(d,e,f));var j=new THREE.Line(h,i);this.scene.add(j)},a.prototype.doubleLineMesh=function(a,b,c,d,e,f,g){var h=new THREE.Geometry,i=new THREE.LineBasicMaterial({color:g});h.vertices.push(new THREE.Vector3(a,b+3,c),new THREE.Vector3(d,e+3,f));var j=new THREE.Line(h,i);this.scene.add(j);var k=new THREE.Geometry,l=new THREE.LineBasicMaterial({color:g});k.vertices.push(new THREE.Vector3(a,b-3,c),new THREE.Vector3(d,e-3,f));var m=new THREE.Line(k,l);this.scene.add(m)},a.prototype.helper=function(a){var b=new THREE.AxisHelper(a);b.position.set(0,0,0),this.scene.add(b)},a.prototype.textMesh=function(a,b,c,d,e){var f=document.createElement("canvas"),g=f.getContext("2d");f.width=128,f.height=128;var h=d;g.font="25px Arial",g.fillStyle=e,g.fillText(h,10,50);var i=new THREE.Texture(f);i.needsUpdate=!0;var j=new THREE.SpriteMaterial({map:i,color:e}),k=new THREE.Sprite(j);k.scale.set(100,100,100),k.position.set(a,b,c),k.rotation.setFromRotationMatrix(this.camera.matrix),this.scene.add(k)},a.prototype.render=function(){this.clock=new THREE.Clock,requestAnimationFrame(this.render.bind(this)),this.trackball.update(),this.renderer.render(this.scene,this.camera)},a}(),url="data/tree.json",data=[],nodeDepth=[];$.getJSON(url,function(a){for(var b=0;b<a.list.length;b++)data[b]=new treeNode(a.list[b].id,a.list[b].parent,a.list[b].marrige,a.list[b].children,0,0,0,0,16777215,null);for(var c=new drawing,d=[],b=0;b<8;b++){var e=100*Math.cos(2*b*Math.PI/8),f=100*Math.sin(2*b*Math.PI/8);d.push([e,f])}for(c.sphereMesh(0,0,0,10,16776960,55),b=0;b<d.length;b++)c.sphereMesh(d[b][0],0,d[b][1],10,16711680,b);for(b=0;b<c.scene.children.length;b++)console.log(c.scene.children[b].id,c.scene.children[b].name);window.onload=function(a){c.onmousemove(a)},$("button").click(function(){c.cameraReset()}),c.render()});